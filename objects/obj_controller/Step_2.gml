if (curState != nextState){
	lastState = curState;
	curState = nextState;
}